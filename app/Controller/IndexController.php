<?php
/**
 * Created by PhpStorm.
 * User: lychee
 * Date: 2018/8/31
 * Time: 17:38
 */

namespace App\Controller;

use App\Components\helper\FileHelper;
use App\Components\helper\Func;
use Breeze\Http\Response;

class IndexController extends BaseController
{
    public function index()
    {
       return $STR=<<<OO
                             <pre style="font-size: small;color: midnightblue">                                                                                                      `
                                                           :%@#####################$!`                                        `
                                                      .!@##################################%'                                  `
                                                  .|########@@@@@@@@@@@@@@@@@@@@@@@@@@@########&;                              `
                                               .|######@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@######@!.                          `
                                             '&#####@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#####@;                        `
                                           `$####@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#####|                      `
                                         .|####@####@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@####!                    `
                                        ;####@@###@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@###@;                  `
                                      .%####@####@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@####$`                `
                                     :@###@@####@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@###@:               `
                                    !####@@####@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@####;              `
                                   |####@@####@@@@#################@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@####!             `
                                  !####@@@###########@&$$%%%%%%%$@#############@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@####;            `
                                 ;####@@@@######|           .``.          `:|&########@@@@@@@###@@@@@@@@@@@@@@@###$`           `
                                '&###@@@@@@@@@##|      .:|&@#@&|`       ..        '|@######@@####@@@@@@@@@@@@@@@###|           `
                                |###@@@@@@@@@###;          .:!!:.    '!&#####&%!'       .;$######@@@@@@@@@@@@@@@###$`          `
                               :@#####@@@@@@@##@'        ...  ...  .:%$$%%%%|!|$&&%'        .%###@@@@@@@@@@@@@@@@##&'          `
                               |######@@@@@@###%.      `;$@&|;'      `'``'`.      .         .%##@@@@@@@@@@@@@@@@@##@:          `
                              .%######@@@@@@##@:        .'''.           `!&####&!`          `$##@@@@@@@@@@@@@@@@@##@:          `
                               !%'!###########;                             .`. .`.         ;###@@@@@@@@@@@@@@@@@##&'          `
                                   .:%@#####|.           .''                               .%###@@@@@@@@@@@@@@@@###%.          `
                                       :@#$`           ;&%'           .;:                  :@##@@@@@@@@@@@@@@@@@###!           `
                                      :@#$.           .`. .|@@@###@&%||||;.               `$###@@@@@@@@@@@@@@@@@##&'           `
                                     .%#&'                   .:|%$&%!;`                   !###@@@@@@@@@@@@@@@@@###!            `
                                     '&#%.               `|$$$$%!'.                      :&###@@@@@@@@@@@@@@#@###%.            `
                                     '&#&'              !@#@;. .'!$@#%'                  `%########@@@@@@@######%.             `
                                      !##$`              :%$$&@#######%.                      :$###############!               `
                  ';:.                .|###|.                      .;:.                          !##@&@#@:'&&:                 `
                :&: .;@&'               '&###@:          .`''`'':!||!`                         `$##|.                          `
          .:!:.   :&!  .|@!              |#######|`       .:%&&$$%|;`                        .|##&'                            `
        !&|$%`;@@$$&|    `$$'         `$##%:''!&#####&;.                                  `%###@:                              `
       :@#&: .%!   `:.     :@@!     !##&!'''''''':|&#########@&%|;:'`.             .:!$######|.                                `
       '$|.'$#%.   `.        :@#$;$#@!:''''''''''':$#&$@##################################&`                                   `
         |#&:..;%:              :&##%'''''''''''''|#@$$@#|''''''''':$####$$#&%|;:::''''':%#%`                                  `
         !%`                      :&#|'''''''''''!@@$$@#%:'''''''''|@#%'%##&&@|'''''''''';&#;                                  `
           :%@########@%|&$'       ;##%''''''':;;$#&$&#&;':;:%##$;:%###%.:@&&&;'''''''''''%#|                                  `
                          `$#|.     !##%''''';%||#@$$@#|:$####@;;@####@: `$@@&;'''''''''''|#%.                                 `
                             !##|.  .%#@|''';&$!&@$%&#$:|##|.`$@:        `$&&#&!''''''''''!@%.                                 `
                               `$##$''&#@!';&@|$#&%$@@!:%#%%#! `%$`        ;$&@###@|:'''''!@$`                                 `
                                  '&#####@$&#%|#@$%&#$:':%#!.!@|                 `!@########|                                  `
                                       `$###&|&#&%$@#%''''!@@!                          |#!                                    `
                                          !@|%#@$$$@@!'''''';$############$:          ;@&'                                     `
                                          :$%&#$%%&#$;''''''''''|@&$%&#%:;$######@@@##$`                                       `
                                            .``...``.           .``..``.      .`'''.                                           `
                        `.                       ``                         ``        .'`                                      `
               `$#!   .!#&:                     '&&'`$#######&'!#######&||;:&&' `$###########@%` ;##&&&&&&&##;                 `
                .;''%&&&&&##@%'                 '&&;'.'&@: :@$` `$#;:&| :#%;&&' `&&'...``':!||`  ;###########;                 `
              .%##$`:&#%`:@&'                  |###@$''&&' :@$`;#######&$#%;&&' `&&!$#$|%@@|'`   ;###########;                 `
               .;&$'  `$##&'   |##############! '&&'  '&$` :@$`   '$|.  :@%;&&' `$&!$@%!|@@%!!::!|||||||||||||!`               `
                '&&''$##@&##$`                  `&&%$:;#%. ;#$`'&######|!@%;&&' '&$;$@!':$#|''`..'||'.!#%'``...                `
                |#@:!&:    !!                   :@#@;;@#;  ;#%.   :@%`  .'`'&&' |#|'$&%&%|#%.!&' !#@: ;##@@@@$`                `
              .%@||##########@:                  ...%#@:!####; !#######&:%###$`'&$'!##&&#!|###|'$#%!@#########&'               `
                                                                                                                               `
                                  `|!`                .:`                              :$;                                     `
                                 '&###########@:     !##$`       |##@@@@@@@@@##!`!%%%%%@#@$%%%%|`                              `
                                ;#@;'$#$%%%%%!.    !##&:  |##;   |#|`':::::'`%#!  |#&%%@#@%%&#%.                               `
                                 `. `$&;......  .%##&'  ;@#$`    |#|:&@|;%#$:%#!  ;$$$$@#@$$$$!                                `
                                    '&@%;;;;;:.   `.  '&#&'      |#|:@&' :@$:%#! '$&&&&@#@&&@#&'                               `
                                 |#$$&;|#$`.%@:     '&#&' ;##;   |#|:@#####$:%#!'&@@##@####@###&:                              `
                                ;#%:$&'   :@&@#|  !@#&:`'::%##%. |#|        .|#! :@###########&'                               `
                                   .|######@:    `$####@&$$%|&#$'|#############!    :@###;                                     `
                                                                                                                               `
     
</pre>
OO;
    }

    public function proxy()
    {
        $path = $this->request->get('path');
        $filename =  substr(md5($path), 0 ,6) .'-'.basename($path);
        $savePath = "/home/upload/youtube/{$filename}";
        $url = Func::getAccessUrl('28799000', "/youtube/{$filename}", 3600);

        if (FileHelper::exist($savePath)) {
            return Response::redirect($url);
        }

        $data = file_get_contents($path);
        FileHelper::createDirectory("/home/upload/youtube/");
        file_put_contents($savePath, $data);
        return Response::redirect($url);
    }

}